<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Évaluation de Maturité ESG</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            ground: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #D9D9D9 0%, #00B0F0 100%);
            color: ;
            padding: 30px;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .progress-bar {
            background: rgba(255,255,255,0.2);
            height: 8px;
            border-radius: 10px;
            margin-top: 20px;
            overflow: hidden;
        }

        .progress-fill {
            background: white;
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .content {
            padding: 40px;
        }

        .category-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e5e7eb;
        }

        .category-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .category-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .category-title h2 {
            font-size: 24px;
            color: #1f2937;
            margin-bottom: 5px;
        }

        .category-title p {
            color: #6b7280;
            font-size: 13px;
        }

        .category-progress {
            text-align: right;
        }

        .category-progress-label {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 5px;
        }

        .category-progress-value {
            font-size: 24px;
            font-weight: bold;
        }

        .question {
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .question.answered {
            background: #E5F8FF;
            border-color: #B7ECFF;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 20px;
        }

        .question-text {
            flex: 1;
        }

        .question-number {
            color: #9ca3af;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .question-content {
            color: #1f2937;
            font-weight: 500;
            line-height: 1.5;
        }

        .question-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .btn-yes {
            background: #e5e7eb;
            color: #4b5563;
        }

        .btn-yes:hover {
            background: #dcfce7;
            color: #00B050;
        }
      

        .btn-yes.active {
            background: #00B050;
            color: white;
            transform: scale(1.05);
        }

        .btn-no {
            background: #e5e7eb;
            color: #4b5563;
        }

        .btn-no:hover {
            background: #fee2e2;
            color: #dc2626;
        }

        .btn-no.active {
            background: #ef4444;
            color: white;
            transform: scale(1.05);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #e5e7eb;
        }

        .btn-nav {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 15px;
        }

        .btn-prev {
            background: #e5e7eb;
            color: #4b5563;
        }

        .btn-prev:hover:not(:disabled) {
            background: #d1d5db;
        }

        .btn-next {
            background: #667eea;
            color: white;
        }

        .btn-next:hover:not(:disabled) {
            background: #5568d3;
        }

        .btn-results {
            background: #22c55e;
            color: white;
        }

        .btn-results:hover:not(:disabled) {
            background: #16a34a;
        }

        .btn-nav:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .nav-hint {
            text-align: center;
            color: #9ca3af;
            font-size: 13px;
            margin-top: 15px;
        }

        .category-dots {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 30px;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #d1d5db;
            transition: all 0.3s;
        }

        .dot.active {
            width: 32px;
            border-radius: 6px;
        }

        /* Results Page */
        .results-container {
            text-align: center;
        }

        .results-header {
            margin-bottom: 40px;
        }

        .results-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .results-title {
            font-size: 32px;
            color: #1f2937;
            margin-bottom: 10px;
        }

        .results-subtitle {
            color: #6b7280;
        }

        .overall-score {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 30px;
            color: white;
            margin-bottom: 40px;
        }

        .overall-score-label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .overall-score-value {
            font-size: 56px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .maturity-badge {
            display: inline-block;
            padding: 10px 24px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 16px;
        }

        .maturity-description {
            margin-top: 10px;
            font-size: 14px;
            opacity: 0.9;
        }

        .category-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .category-card {
            border: 3px solid;
            border-radius: 12px;
            padding: 24px;
            text-align: left;
        }

        .category-card-icon {
            font-size: 40px;
            margin-bottom: 15px;
        }

        .category-card-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #1f2937;
        }

        .category-card-score {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .category-card-details {
            font-size: 13px;
            color: #6b7280;
            margin-bottom: 10px;
        }

        .category-card-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            color: white;
        }

        .charts-container {
            margin-bottom: 40px;
        }

        .chart-wrapper {
            background: #f9fafb;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #1f2937;
        }

        .recommendations {
            background: #f9fafb;
            border-radius: 12px;
            padding: 30px;
            text-align: left;
            margin-bottom: 30px;
        }

        .recommendations h3 {
            font-size: 20px;
            margin-bottom: 20px;
            color: #1f2937;
        }

        .recommendation-item {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .recommendation-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-top: 8px;
            flex-shrink: 0;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Questionnaire de Maturité ESG</h1>
            <p>Évaluez les pratiques Environnementales, Sociales et de Gouvernance de votre entreprise</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
        </div>

        <div id="questionnaireSection" class="content">
            <div class="category-header">
                <div class="category-info">
                    <div class="category-icon" id="categoryIcon"></div>
                    <div class="category-title">
                        <h2 id="categoryTitle"></h2>
                        <p id="categorySubtitle"></p>
                    </div>
                </div>
                <div class="category-progress">
                    <div class="category-progress-label">Complété</div>
                    <div class="category-progress-value" id="categoryProgress"></div>
                </div>
            </div>

            <div id="questionsContainer"></div>

            <div class="navigation">
                <button class="btn-nav btn-prev" id="btnPrev" onclick="previousCategory()">← Précédent</button>
                <button class="btn-nav btn-next" id="btnNext" onclick="nextCategory()">Suivant →</button>
                <button class="btn-nav btn-results hidden" id="btnResults" onclick="showResults()">Voir les Résultats</button>
            </div>
            <div class="nav-hint" id="navHint">Veuillez répondre à toutes les questions pour continuer</div>

            <div class="category-dots" id="categoryDots"></div>
        </div>

        <div id="resultsSection" class="content hidden">
            <div class="results-container">
                <div class="results-header">
                    <div class="results-icon"></div>
                    <h1 class="results-title">Résultats de l'Évaluation ESG</h1>
                    <p class="results-subtitle">Aperçu de la Performance ESG de votre Entreprise</p>
                </div>

                <div class="overall-score" id="overallScoreCard"></div>

                <div class="charts-container">
                    <div class="chart-wrapper">
                        <h3 class="chart-title">Scores par Catégorie</h3>
                        <canvas id="barChart" height="100"></canvas>
                    </div>
                </div>

                <div class="category-cards" id="categoryCards"></div>

                <div class="recommendations" id="recommendations"></div>

                <button class="btn-nav btn-next" onclick="resetQuestionnaire()">Nouvelle Évaluation</button>
            </div>
        </div>
    </div>

    <script>
        const categories = [
            {
                name: 'Environnemental',
                icon: '',
                color: '#10b981',
                questions: [
                    'Votre entreprise mesure-t-elle et suit-elle ses émissions de gaz à effet de serre ?',
                    "Disposez vous d'une trajectoire de réduction de vos émissions de gaz à effet de serre ?",
                    'Faites-vous la promotion de la mobilité douce ? '
                  ,"Votre flotte automobile fait-elle l'objet d'une transition vers des véhicules électriques ?",
                    "Disposez-vous d'une politique de tri des déchets ? ",
                  "Les déchets dangereux font-ils l'objet d'un traitement particulier ? ",
                    "Achetez-vous de l'énergie dites 'verte' ?",
                    "Avez-vous des mesures de conservation de l'eau en place ?",
          
                    "Avez-vous déjà réalisé une ACV de vos biens ou services proposés à la vente ?",
                    
                    "L'ensemble de vos politiques environnemetales sont-elle documentées, suivies, objectivées ?"
                ]
            },
            {
                name: 'Social',
                icon: '',
                color: '#3b82f6',
                questions: [
                    'Votre entreprise a-t-elle une politique de diversité et d\'inclusion ?',
                    'Proposez-vous des formations sur la santé et la sécurité des employés ?',
                      "Disposez-vous d'indicateur de mesure des accidents du travail comme le taux de fréquence ou le taux de gravité ?",
                    'Le résultat de votre index Égapro est-il supérieur à 85 points ?',
                    'Avez-vous des politiques anti-discrimination et anti-harcèlement ?', 'Avez-vous des mécanismes de protection des lanceurs d\'alerte ?',
                
                    'Menez-vous des enquêtes de satisfaction auprès de vos clients comme des baromètres sociaux ?',
                    "Disposez-vous d'un plan de formation ?",
                    'Avez-vous des politiques sur les droits humains pour votre chaîne d\'approvisionnement ?',
                    'Vos fournisseurs sont-ils engagés dans ces démarches ?'
                   
                ]
            },
            {
                name: 'Gouvernance',
                icon: '',
                color: '#8b5cf6',
                questions: [
                    'Disposez-vous d\'une politique d\'achats responsables ?',
                    'Votre entreprise a-t-elle un code d\'éthique et de conduite ?',
                    'Votre entreprise a-t-elle des politiques anti-corruption ?',
                    'Disposez-vous de certifications émanant d\'organismes reconnus ?',
                    'Votre entreprise s\'engage-t-elle auprès des communautés locales et des territoires ?',
                    'Avez-vous des politiques transparentes de rémunération des dirigeants ?',
                    'Votre entreprise a-t-elle une politique de protection des données ?',
                    'Avez-vous des procédures de gestion des risques en place ?',
                    'Votre entreprise publie-t-elle des rapports de développement durable ?',
                    'Avez-vous procédé à l\'identification de vos parties prenantes ?'
                ]
            }
        ];

        let currentCategory = 0;
        let answers = {};

        function initQuestionnaire() {
            renderCategoryDots();
            renderCategory();
        }

        function renderCategoryDots() {
            const dotsContainer = document.getElementById('categoryDots');
            dotsContainer.innerHTML = categories.map((cat, idx) => 
                `<div class="dot ${idx === currentCategory ? 'active' : ''}" style="background-color: ${idx <= currentCategory ? cat.color : '#d1d5db'}"></div>`
            ).join('');
        }

        function renderCategory() {
            const category = categories[currentCategory];
            
            document.getElementById('categoryIcon').innerHTML = category.icon;
            document.getElementById('categoryIcon').style.backgroundColor = category.color + '20';
            document.getElementById('categoryIcon').style.color = category.color;
            
            document.getElementById('categoryTitle').textContent = category.name;
            document.getElementById('categorySubtitle').textContent = `Catégorie ${currentCategory + 1} sur ${categories.length}`;
            
            updateCategoryProgress();
            renderQuestions();
            updateNavigation();
            updateProgressBar();
            renderCategoryDots();
        }

        function renderQuestions() {
            const category = categories[currentCategory];
            const container = document.getElementById('questionsContainer');
            
            container.innerHTML = category.questions.map((question, idx) => {
                const key = `${currentCategory}-${idx}`;
                const answer = answers[key];
                
                return `
                    <div class="question ${answer !== undefined ? 'answered' : ''}">
                        <div class="question-header">
                            <div class="question-text">
                                <div class="question-number">Q${idx + 1}</div>
                                <div class="question-content">${question}</div>
                            </div>
                            <div class="question-buttons">
                                <button class="btn btn-yes ${answer === true ? 'active' : ''}" onclick="handleAnswer(${idx}, true)">
                                     Oui
                                </button>
                                <button class="btn btn-no ${answer === false ? 'active' : ''}" onclick="handleAnswer(${idx}, false)">
                                     Non
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function handleAnswer(questionIndex, answer) {
            const key = `${currentCategory}-${questionIndex}`;
            answers[key] = answer;
            updateCategoryProgress();
            renderQuestions();
            updateNavigation();
        }

        function updateCategoryProgress() {
            const category = categories[currentCategory];
            const answeredCount = category.questions.filter((_, idx) => {
                const key = `${currentCategory}-${idx}`;
                return answers[key] !== undefined;
            }).length;
            
            document.getElementById('categoryProgress').textContent = `${answeredCount}/${category.questions.length}`;
            document.getElementById('categoryProgress').style.color = categories[currentCategory].color;
        }

        function isCurrentCategoryComplete() {
            const category = categories[currentCategory];
            return category.questions.every((_, idx) => {
                const key = `${currentCategory}-${idx}`;
                return answers[key] !== undefined;
            });
        }

        function updateNavigation() {
            const isComplete = isCurrentCategoryComplete();
            const btnPrev = document.getElementById('btnPrev');
            const btnNext = document.getElementById('btnNext');
            const btnResults = document.getElementById('btnResults');
            const navHint = document.getElementById('navHint');
            
            btnPrev.disabled = currentCategory === 0;
            
            if (currentCategory === categories.length - 1) {
                btnNext.classList.add('hidden');
                btnResults.classList.remove('hidden');
                btnResults.disabled = !isComplete;
            } else {
                btnNext.classList.remove('hidden');
                btnResults.classList.add('hidden');
                btnNext.disabled = !isComplete;
            }
            
            navHint.style.display = isComplete ? 'none' : 'block';
        }

        function updateProgressBar() {
            const progress = ((currentCategory + 1) / categories.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        function nextCategory() {
            if (isCurrentCategoryComplete() && currentCategory < categories.length - 1) {
                currentCategory++;
                renderCategory();
            }
        }

        function previousCategory() {
            if (currentCategory > 0) {
                currentCategory--;
                renderCategory();
            }
        }

        function calculateScores() {
            return categories.map((category, catIndex) => {
                let yesCount = 0;
                category.questions.forEach((_, qIndex) => {
                    const key = `${catIndex}-${qIndex}`;
                    if (answers[key] === true) yesCount++;
                });
                return {
                    category: category.name,
                    icon: category.icon,
                    color: category.color,
                    score: (yesCount / category.questions.length) * 100,
                    yesCount: yesCount,
                    totalQuestions: category.questions.length
                };
            });
        }

        function getMaturityLevel(score) {
            if (score >= 80) return { level: 'Avancé', color: '#10b981', description: 'Niveau de maturité élevé' };
            if (score >= 60) return { level: 'Intermédiaire', color: '#3b82f6', description: 'Des bonnes bases qui peuvent cependant être améliorées' };
            if (score >= 40) return { level: 'En développement', color: '#f59e0b', description: 'Fondations en construction' };
            return { level: 'Initial', color: '#ef4444', description: 'Premières étapes' };
        }

        function showResults() {
            if (!isCurrentCategoryComplete()) return;
            
            document.getElementById('questionnaireSection').classList.add('hidden');
            document.getElementById('resultsSection').classList.remove('hidden');
            
            const scores = calculateScores();
            const overallScore = scores.reduce((sum, s) => sum + s.score, 0) / scores.length;
            const maturity = getMaturityLevel(overallScore);
            
            // Overall Score Card
            document.getElementById('overallScoreCard').innerHTML = `
                <div class="overall-score-label">Score Global de Maturité</div>
                <div class="overall-score-value">${overallScore.toFixed(1)}%</div>
                <div class="maturity-badge" style="background-color: ${maturity.color}">
                    ${maturity.level}
                </div>
                <div class="maturity-description">${maturity.description}</div>
            `;
            
            // Category Cards
            document.getElementById('categoryCards').innerHTML = scores.map(score => {
                const catMaturity = getMaturityLevel(score.score);
                return `
                    <div class="category-card" style="border-color: ${score.color}">
                        <div class="category-card-icon">${score.icon}</div>
                        <div class="category-card-title">${score.category}</div>
                        <div class="category-card-score" style="color: ${score.color}">${score.score.toFixed(0)}%</div>
                        <div class="category-card-details">${score.yesCount} sur ${score.totalQuestions} critères remplis</div>
                        <div class="category-card-badge" style="background-color: ${catMaturity.color}">
                            ${catMaturity.level}
                        </div>
                    </div>
                `;
            }).join('');
            
            // Recommendations
            let recommendations = '<h3>Recommandations</h3>';
            scores.forEach(score => {
                if (score.score < 60) {
                    recommendations += `
                        <div class="recommendation-item">
                            <div class="recommendation-dot" style="background-color: ${score.color}"></div>
                            <div><strong>${score.category} :</strong> Envisagez un accompagnement avec le Groupe Y afin de devenir des rock-stars de la thématique.</div>
                        </div>
                    `;
                }
            });
            if (overallScore >= 60) {
                recommendations += `
                    <div class="recommendation-item">
                        <div class="recommendation-dot" style="background-color: #10b981"></div>
                        <div>Vous disposez de solides fondations. Un approfondissement du diagnositic peut être envisagé afin de cibler des axes de progrés plus précis.</div>
                    </div>
                `;
            }
            document.getElementById('recommendations').innerHTML = recommendations;
            
            // Bar Chart
            renderBarChart(scores);
        }

        function renderBarChart(scores) {
            const ctx = document.getElementById('barChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: scores.map(s => s.category),
                    datasets: [{
                        label: 'Score (%)',
                        data: scores.map(s => s.score),
                        backgroundColor: scores.map(s => s.color),
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        function resetQuestionnaire() {
            answers = {};
            currentCategory = 0;
            document.getElementById('questionnaireSection').classList.remove('hidden');
            document.getElementById('resultsSection').classList.add('hidden');
            initQuestionnaire();
        }

        // Initialize on page load
        initQuestionnaire();
    </script>
</body>
</html>
